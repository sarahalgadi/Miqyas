<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Assessment: Grades</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 

    <link rel="stylesheet" href="../public/stylesheets/courseReport.css">
</head>

<body>

    <hr>
    <div class="row container-fluid" style="font-family:Arial, Helvetica, sans-serif">
        <div class="col-md-8">
            <h2 style="font-weight: 600; margin: 1rem; padding: 1rem;">SE322: Software Design & Architecture</h2>
            <h2 style="font-weight: 600; margin: 1rem; padding: 1rem;">CLO Assessment Course Report</h2>
            <h2 style="font-weight: 400; margin: 1rem; padding: 1rem;">Direct Assessment Results</h2>
        </div>
        <div class="col-md-4">
            <h2 style="font-weight: 600; margin-top: 1rem; margin-left: 20%; padding: 1rem; font-size: x-large;">Term
                231</h2>
        </div>
    </div>
    <div class="container">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>CLO Number</th>
                    <th>BE</th>
                    <th>DE</th>
                    <th>ME</th>
                    <th>AE</th>
                    <th>Results</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>CLO 1</td>
                    <td>3</td>
                    <td>2</td>
                    <td>4</td>
                    <td>8</td>
                    <td>70%</td>
                </tr>
                <tr>
                    <td>CLO 2</td>
                    <td>2</td>
                    <td>3</td>
                    <td>4</td>
                    <td>8</td>
                    <td>70%</td>
                </tr>
            </tbody>
        </table>
        <div class="dropdown">
            <button type="button" class="btn custom-button dropdown-toggle" style="margin-left: 0;" data-bs-toggle="dropdown">
                Filter
            </button>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">Software Engineering</a></li>
            </ul>
        </div>
    </div>
    <div class="row container-fluid" style="font-family:Arial, Helvetica, sans-serif">
        <h2 style="font-weight: 400; margin: 1rem; padding: 1rem;">Indirect Assessment Results</h2>
    </div>
    <div class="container" id="result">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>CLO Number</th>
                    <th>Not Satisfied</th>
                    <th>Barely Satisfied</th>
                    <th>Satisfied</th>
                    <th>Adequately Satisfied</th>
                    <th>Fully Satisfied</th>
                    <th>Achievement Results</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>CLO 1</td>
                    <td>0</td>
                    <td>3</td>
                    <td>2</td>
                    <td>4</td>
                    <td>8</td>
                    <td>70%</td>
                </tr>
                <tr>
                    <td>CLO 2</td>
                    <td>0</td>
                    <td>3</td>
                    <td>2</td>
                    <td>4</td>
                    <td>8</td>
                    <td>70%</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="row container-fluid" style="font-family:Arial, Helvetica, sans-serif">
        <h2 style="font-weight: 400; margin: 1rem; padding: 1rem;">Overall Assessment Results</h2>
    </div>
    <div class="container" id="result">
        <canvas id="assessmentChart" width="400" height="130"></canvas>
    </div>
    <div class="row container-fluid" style="font-family:Arial, Helvetica, sans-serif">
        <h2 style="font-weight: 400; margin: 1rem; padding: 1rem;">Select Action Plan:</h2>
    </div>
    <form action="/save-course-report" method="post">
        <div class="container" id="result">
            <!-- im using dummy data for sections, but thru database, you should get the sections with action plans only.-->
           <% const sections = ['Section 323', 'Section 324', 'Section 325']; %>
           <div class="checkbox-sections">
               <% sections.forEach((section, index) => { %>
                   <label class="form-check-label">
                       <input type="checkbox" class="form-check-input sectionCheckbox" id="<%= `showTableSection${index}` %>"> <%= section %>
                   </label><br>
                   <table class="table table-bordered d-none" id="<%= `actionPlan${index}` %>">
                       <thead>
                           <tr>
                               <th rowspan="2">CLO Number</th>
                               <th colspan="5">Action Plan & Recommendation
                                   <tr>
                                       <th>Action</th>
                                       <th>Responsible</th>
                                       <th>Start Time</th>
                                       <th>End Time</th>
                                       <th>Resources</th>
                                   </tr>
                               </th>
                           </tr>
                       </thead>
                       <tbody>
                           <!-- here we'll use ejs for the course code, semester, and clo and get action plan data from sections-->
                       </tbody>
                   </table>
               <% }); %>
           </div>
           <button type="submit" class="btn custom-button" style="margin-left: 75%">Save Report</button>

       </div>
    </form>
   
</body>

<script>
        // histogram script
        // This script will be put in a separate file and imported to make the code cleaner
        // Dummy data will be included once the report is loaded
        // Complex SQL queries are needed to get this data; from app.js, it'll be included as router info
        // Once we have a proper database, this will be fixed with EJS and routes
        // Are we taking direct and indirect as decimals, which we'll later convert to percentages?

        const cloData = [
            { clo: 'CLO 1', directResult: 70, indirectResult: 60 },
            { clo: 'CLO 2', directResult: 80, indirectResult: 75 },
            { clo: 'CLO 3', directResult: 90, indirectResult: 15 }
        ];

        const cloLabels = cloData.map(item => item.clo);
        const directResults = cloData.map(item => item.directResult);
        const indirectResults = cloData.map(item => item.indirectResult);

        const ctx = document.getElementById('assessmentChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: cloLabels,
                datasets: [
                    {
                        label: 'Direct Results',
                        backgroundColor: 'rgba(21, 65, 110, 0.9)',
                        borderColor: 'rgba(96, 137, 179)',
                        borderWidth: 1,
                        data: directResults,
                    },
                    {
                        label: 'Indirect Results',
                        backgroundColor: 'rgba(174, 183, 191, 0.8)',
                        borderColor: 'rgba(225, 230, 235)',
                        borderWidth: 1,
                        data: indirectResults,
                    },
                ],
            },
            options: {
                scales: {
                    y: {
                        beginAtZero: true,
                    },
                },
            },
        });
    ;
</script>
<script>
    const sectionCheckboxes = document.querySelectorAll('.sectionCheckbox');

    // Add an event listener to each section checkbox (once i click on section, it will show the action plan table!)
    sectionCheckboxes.forEach((sectionCheckbox, index) => {
        const actionPlanTable = document.getElementById(`actionPlan${index}`);

        sectionCheckbox.addEventListener('change', function () {
            // If the section checkbox is checked, show the corresponding action plan table; otherwise, hide it
            actionPlanTable.classList.toggle('d-none', !this.checked);
        });
    });
</script>



</html>
